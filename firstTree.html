<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="stylesheets/styles.css">
    <title>A tree</title>
	<!--<script language=JavaScript src="javascripts/scripts.js"></script>-->
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  </head>
  <body>
    <div id="cont">
	</div>
	
	
    <script>
	
	function visit(parent, visitFn, childrenFn)
{
    if (!parent) return;

    visitFn(parent);

    var children = childrenFn(parent);
    if (children) {
        var count = children.length;
        for (var i = 0; i < count; i++) {
            visit(children[i], visitFn, childrenFn);
        }
    }
}
	
	var treeData = {
    name: "/",
    contents: [
        {
            name: "Applications",
            contents: [
                { name: "Mail.app" },
                { name: "iPhoto.app" },
                { name: "Keynote.app" },
                { name: "iTunes.app" },
                { name: "XCode.app" },
                { name: "Numbers.app" },
                { name: "Pages.app" }
            ]
        },
        {
            name: "System",
            contents: []
        },
        {
            name: "Library",
            contents: [
                {
                    name: "Application Support",
                    contents: [
                        { name: "Adobe" },
                        { name: "Apple" },
                        { name: "Google" },
                        { name: "Microsoft" }
                    ]
                },
                {
                    name: "Languages",
                    contents: [
                        { name: "Ruby" },
                        { name: "Python" },
                        { name: "Javascript" },
                        { name: "C#" }
                    ]
                },
                {
                    name: "Developer",
                    contents: [
                        { name: "4.2" },
                        { name: "4.3" },
                        { name: "5.0" },
                        { name: "Documentation" }
                    ]
                }
            ]
        },
        {
            name: "opt",
            contents: []
        },
        {
            name: "Users",
            contents: [
                { name: "pavanpodila" },
                { name: "admin" },
                { name: "test-user" }
            ]
        }
    ]
};

	var size = {width:500, height:500};
	
	    // Calculate total nodes, max label length
    var totalNodes = 0;
    var maxLabelLength = 0;
    visit(treeData, function(d)
    {
        totalNodes++;
        maxLabelLength = Math.max(d.name.length, maxLabelLength);
    }, function(d)
    {
        return d.contents && d.contents.length > 0 ? d.contents : null;
    });
	
	
	var tree = d3.layout.tree()
		.sort(null)
		.size([size.height, size.width - maxLabelLength*10])
		.children(function(d)
			{
				return (!d.contents || d.contents.length === 0) ? null : d.contents;
			});

	var nodes = tree.nodes(treeData);
	var links = tree.links(nodes);
	
	
	
	/*
     <svg>
         <g class="container" />
     </svg>
  */
	var layoutRoot = d3.select("#cont")
		.append("svg:svg").attr("width", size.width).attr("height", size.height)
		.append("svg:g")
		.attr("class", "container")
		.attr("transform", "translate(" + maxLabelLength + ",0)");


	// Edges between nodes as a <path class="link" />
	var link = d3.svg.diagonal()
		.projection(function(d)
			{
				return [d.y, d.x];
			});

	layoutRoot.selectAll("path.link")
		.data(links)
		.enter()
		.append("svg:path")
		.attr("class", "link")
		.attr("d", link);


	/*
     Nodes as
     <g class="node">
         <circle class="node-dot" />
         <text />
     </g>
	*/
	var nodeGroup = layoutRoot.selectAll("g.node")
		.data(nodes)
		.enter()
		.append("svg:g")
		.attr("class", "node")
		.attr("transform", function(d)
			{
				return "translate(" + d.y + "," + d.x + ")";
			});

	//nodeGroup.append("svg:circle")
	//	.attr("class", "node-dot")
	//	.attr("r", options.nodeRadius);

	nodeGroup.append("svg:text")
		.attr("text-anchor", function(d)
			{
				return d.children ? "end" : "start";
			})
		.attr("dx", function(d)
			{
				var gap = 2; //* options.nodeRadius;
				return d.children ? -gap : gap;
			})
		.attr("dy", 3)
		.text(function(d)
			{
				return d.name;
			});
	
	
	
	</script>
	
	    
  </body>
</html>